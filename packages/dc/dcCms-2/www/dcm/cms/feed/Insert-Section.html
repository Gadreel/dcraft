<dc.Html Title="Insert Section" AuthTags="Admin,Editor">
	<dc.Body>
		<dc.Panel Title="Section Options">
			<dcf.Form Name="DepIsSection" AlwaysNew="true">
				<dcf.FormButtons>
					<dcf.SubmitButton Label="Next" />
				</dcf.FormButtons>
				
				<dcf.RadioGroup Label="Section Type" Name="Plugin" Required="true">
				   <RadioButton Value="StandardSection" Label="Markdown" />
				   <RadioButton Value="PairedMediaSection" Label="Markdown paired with Media" />
				   <RadioButton Value="GallerySection" Label="Images Linked to Gallery" />
				   <RadioButton Value="HtmlSection" Label="Html" />
				</dcf.RadioGroup>
			</dcf.Form>
		</dc.Panel>
	</dc.Body>
	<dc.Function Name="LoadRecord" Params="e"><![CDATA[
			var entry = this;
			
			e.Data = {
				Plugin: 'StandardSection'
			};
    ]]></dc.Function>
	<dc.Function Name="AfterSave"><![CDATA[
			var entry = this;
			
		    var ctx = dc.pui.App.Context;
			
			if (!ctx.Params.Section.Id)
				ctx.Params.Section.Id = 'sectAuto' + dc.util.Crypto.makeSimpleKey();
				
			ctx.Params.Section.Plugin = entry.form().getValue('Plugin');
			
			// TODO improve this area - abstract the editor
			if (ctx.Params.Section.Plugin == 'GallerySection') {
				ctx.Menu = 'dcmPagePartGallerySection';
				dc.pui.App.loadPage('/dcm/cms/feed/Edit-Section-Gallery');
			}
			else {
				ctx.Menu = 'dcmPagePartSection';
				dc.pui.App.loadPage('/dcm/cms/feed/Edit-Section-Content');
			}
			
			entry.Layer.back();
	]]></dc.Function>
</dc.Html>